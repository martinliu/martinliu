<!doctype html><html lang=zh><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>在 RHEL 7 上安装 Foreman 1.8 - Martin Liu's Blog</title><meta property="og:title" content="在 RHEL 7 上安装 Foreman 1.8"><meta name=twitter:title content="在 RHEL 7 上安装 Foreman 1.8"><meta name=description content="Foreman 是一个发展的越来越好的开源项目，具备很多成功开源项目的相同特质：简单强大的核心装机和自动化配置功能、开放的插件架构下已经开发出足够丰富的周边功能，资源池集成插件涵盖各种服务器虚拟化和云主机，配置自动化控制方面集成了puppet和salt等。本文简述了如何在RHEL7上安装最新版本的Foremen 1.8.2"><meta property="og:description" content="Foreman 是一个发展的越来越好的开源项目，具备很多成功开源项目的相同特质：简单强大的核心装机和自动化配置功能、开放的插件架构下已经开发出足够丰富的周边功能，资源池集成插件涵盖各种服务器虚拟化和云主机，配置自动化控制方面集成了puppet和salt等。本文简述了如何在RHEL7上安装最新版本的Foremen 1.8.2"><meta name=twitter:description content="Foreman 是一个发展的越来越好的开源项目，具备很多成功开源项目的相同特质：简单强大的核心装机和自动化配置功能、开放的插件架构下已经开发出足够丰富的周边功能，资源池集成插件涵盖各种服务器虚拟化和云主机，配置自动化控制方面集成了puppet和salt等。本文简述了如何在RHEL7上安装最新版本的Foremen 1.8.2"><meta name=author content="刘征 Martin Liu"><link href=https://martinliu.cn/favicon.ico rel=icon type=image/x-icon><meta name=msvalidate.01 content="12F570013342D1F8B60A455D09221C1D"><meta name=yandex-verification content="7e9acc85531b0f35"><meta name=google-site-verification content="4oSwNTpy1vzip3_lt6XhkhMfImCD_DZlvL3K1k-M8qk"><meta name=baidu-site-verification content="Z7d1tYkxzQ"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-TL37V8G');</script><meta property="og:image" content="https://res.cloudinary.com/martinliu/image/upload/q_auto:eco/avatar.jpg"><meta name=twitter:image content="https://res.cloudinary.com/martinliu/image/upload/q_auto:eco/avatar.jpg"><meta name=twitter:card content="summary"><meta name=twitter:site content="@martinliu"><meta name=twitter:creator content="@martinliu"><meta property="og:url" content="https://martinliu.cn/2015/06/16/e59ca8-rhel-7-e4b88ae5ae89e8a385-foreman-1-8/"><meta property="og:type" content="website"><meta property="og:site_name" content="Martin's Blog"><meta name=keywords content><meta name=generator content="Hugo 0.80.0"><link rel=canonical href=https://martinliu.cn/2015/06/16/e59ca8-rhel-7-e4b88ae5ae89e8a385-foreman-1-8/><link rel=alternate href=https://martinliu.cn/index.xml type=application/rss+xml title="Martin's Blog"><script src=https://res.cloudinary.com/martinliu/raw/upload/static/jquery-1.12.4.min.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css integrity=sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0 crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://martinliu.cn/css/main.css><link rel=stylesheet href=https://martinliu.cn/css/search.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://martinliu.cn/css/prism.css><script data-ad-client=ca-pub-4545355461463255 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-749876-6','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>切换导航</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://martinliu.cn/>Martin's Blog</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=首页 href=https://martinliu.cn/>首页</a></li><li><a title=标签 href=https://martinliu.cn/tags>标签</a></li><li><a title=关于 href=https://martinliu.cn/about>关于</a></li><li><a title=书籍 href=https://martinliu.cn/book>书籍</a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title="Martin's Blog" href=https://martinliu.cn/><img class=avatar-img src=https://res.cloudinary.com/martinliu/image/upload/q_auto:eco/avatar.jpg alt="Martin's Blog"></a></div></div></div></nav><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-12 col-md-12 col-md-offset-0"><div class=posts-heading><h1 align=center>在 RHEL 7 上安装 Foreman 1.8</h1><h2 align=center class=posts-subheading>Foreman 是一个发展的越来越好的开源项目，具备很多成功开源项目的相同特质：简单强大的核心装机和自动化配置功能、开放的插件架构下已经开发出足够丰富的周边功能，资源池集成插件涵盖各种服务器虚拟化和云主机，配置自动化控制方面集成了puppet和salt等。本文简述了如何在RHEL7上安装最新版本的Foremen 1.8.2</h2></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div><h5 id=wc>字数：1400 |大约阅读时间 3 分钟</h5><h5 id=tags>标签:
<a href=https://martinliu.cn//tags/foreman>Foreman</a> &nbsp;
<a href=https://martinliu.cn//tags/puppet>puppet</a> &nbsp;
<a href=https://martinliu.cn//tags/rhel>RHEL</a> &nbsp;
<a href=https://martinliu.cn//tags/yum>Yum</a> &nbsp;</h5></div><article role=main class=blog-post><p>首先安装RHEL7使用光盘安装最小化系统，安装完成之后，关闭防火墙和SELinux（为了测试方便），配置主机名为FQDN格式，如 fm1.8.xenlab.com； 加本机的主机名解析到/etc/hosts 文集中。之后注册到RHN。</p><p>[bash]</p><p>[root@fm18 ~]# subscription-manager register
[root@fm18 ~]# subscription-manager attach  &ndash;auto
[root@fm18 ~]# subscription-manager repos &ndash;disable="*"
[root@fm18 ~]# subscription-manager repos &ndash;enable=rhel-7-server-optional-rpms
[root@fm18 ~]# subscription-manager repos &ndash;enable=rhel-server-rhscl-7-rpms
[root@fm18 ~]# subscription-manager repos &ndash;enable=rhel-7-server-rpms
[root@fm18 ~]# rpm -ivh <a href=http://yum.puppetlabs.com/puppetlabs-release-el-7.noarch.rpm>http://yum.puppetlabs.com/puppetlabs-release-el-7.noarch.rpm</a>
[root@fm18 ~]# yum -y install <a href=http://yum.theforeman.org/releases/1.8/el7/x86_64/foreman-release.rpm>http://yum.theforeman.org/releases/1.8/el7/x86_64/foreman-release.rpm</a>
[root@fm18 ~]# yum -y install <a href=http://ftp.sjtu.edu.cn/fedora/epel/epel-release-latest-7.noarch.rpm>http://ftp.sjtu.edu.cn/fedora/epel/epel-release-latest-7.noarch.rpm</a>
[root@fm18 ~]# yum clean all
[root@fm18 ~]# yum makecache
[root@fm18 ~]# yum update -y
[root@fm18 ~]# reboot
[root@fm18 ~]# yum install foreman-installer</p><p>[/bash]</p><p>安装foreman-installer可能会出现的错误是ruby包依赖的问题，导致这个问题的原因可能有：网速太满导致的yum meta-data 失效，国外的epel源下载失败等。解决方法是：使用国内较快的epel源，在安装foreman-installer前，清除yum 缓存，重新建立yum原数据缓存。</p><p>我的测试机的yum 源配置如下：</p><p>[bash]</p><p>[root@fm18 yum.repos.d]# yum repolist
Loaded plugins: fastestmirror, product-id, subscription-manager
Loading mirror speeds from cached hostfile</p><ul><li>epel: mirrors.neusoft.edu.cn
repo id repo name status
epel/x86_64 Extra Packages for Enterprise Linux 7 - x86_64 8,076
foreman/x86_64 Foreman 1.8 379
foreman-plugins/x86_64 Foreman plugins 1.8 199
puppetlabs-deps/x86_64 Puppet Labs Dependencies El 7 - x86_64 17
puppetlabs-products/x86_64 Puppet Labs Products El 7 - x86_64 175
rhel-7-server-optional-rpms/7Server/x86_64 Red Hat Enterprise Linux 7 Server - Optional (RPMs) 5,832
rhel-7-server-rpms/7Server/x86_64 Red Hat Enterprise Linux 7 Server (RPMs) 7,036
rhel-server-rhscl-7-rpms/7Server/x86_64 Red Hat Software Collections RPMs for Red Hat Enterprise Linux 7 Server 3,596
repolist: 25,310
[root@fm18 yum.repos.d]# cat /etc/yum.repos.d/epel.repo
[epel]
name=Extra Packages for Enterprise Linux 7 - $basearch
baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch
#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch
failovermethod=priority
enabled=1
gpgcheck=1
gpgkey=https://fedoraproject.org/static/352C64E5.txt</li></ul><p>mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch
[epel-debuginfo]
name=Extra Packages for Enterprise Linux 7 - $basearch - Debug
baseurl=http://ftp.sjtu.edu.cn/fedora/epel/7/$basearch/debug
#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-debug-7&arch=$basearch
failovermethod=priority
enabled=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
gpgcheck=1</p><p>[epel-source]
name=Extra Packages for Enterprise Linux 7 - $basearch - Source
baseurl=http://ftp.sjtu.edu.cn/fedora/epel/7/SRPMS
#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-source-7&arch=$basearch
failovermethod=priority
enabled=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
gpgcheck=1
[root@fm18 yum.repos.d]#</p><p>[/bash]</p><p>以上应该是安装foreman-installer宝过的攻略了。接下来该安装foreman的各个组建和插件了。使用 foreman-installer -i 发现是个不错的方法。还可以顺便了解一下当前foreman版本的各个主要功能项，如下所示：</p><p>[bash]</p><h2 id=welcome-to-the-foreman-installer>[root@fm18 yum.repos.d]# foreman-installer -i
Welcome to the Foreman installer!</h2><p>This wizard will gather all required information. You can change any parameter
to your needs.</p><p>Ready to start? (y/n) y</p><p>Main Config Menu</p><ol><li>[✓] Configure foreman</li><li>[✓] Configure foreman_cli</li><li>[✗] Configure foreman_compute_ec2</li><li>[✗] Configure foreman_compute_gce</li><li>[✓] Configure foreman_compute_libvirt</li><li>[✗] Configure foreman_compute_openstack</li><li>[✓] Configure foreman_compute_ovirt</li><li>[✗] Configure foreman_compute_rackspace</li><li>[✗] Configure foreman_compute_vmware</li><li>[✓] Configure foreman_plugin_bootdisk</li><li>[✗] Configure foreman_plugin_chef</li><li>[✓] Configure foreman_plugin_default_hostgroup</li><li>[✗] Configure foreman_plugin_digitalocean</li><li>[✓] Configure foreman_plugin_discovery</li><li>[✗] Configure foreman_plugin_docker</li><li>[✗] Configure foreman_plugin_hooks</li><li>[✗] Configure foreman_plugin_openscap</li><li>[✗] Configure foreman_plugin_ovirt_provision</li><li>[✗] Configure foreman_plugin_puppetdb</li><li>[✗] Configure foreman_plugin_salt</li><li>[✓] Configure foreman_plugin_setup</li><li>[✓] Configure foreman_plugin_tasks</li><li>[✗] Configure foreman_plugin_templates</li><li>[✓] Configure foreman_proxy</li><li>[✗] Configure foreman_proxy_plugin_abrt</li><li>[✗] Configure foreman_proxy_plugin_chef</li><li>[✗] Configure foreman_proxy_plugin_openscap</li><li>[✗] Configure foreman_proxy_plugin_pulp</li><li>[✗] Configure foreman_proxy_plugin_salt</li><li>[✓] Configure puppet</li><li>Display current config</li><li>Save and run</li><li>Cancel run without Saving
Choose an option from the menu&mldr;</li></ol><p>[root@fm18 yum.repos.d]# puppet agent &ndash;test
Info: Retrieving pluginfacts
Info: Retrieving plugin
Info: Caching catalog for fm18.xenlab.com
Info: Applying configuration version &lsquo;1434466089&rsquo;
Notice: Finished catalog run in 0.21 seconds
[root@fm18 yum.repos.d]#</p><p>[/bash]</p><p>输入数字即可进入每个选项打开和关闭这个功能和服务，这个是对foreman的功能配置管理，不光是首次安装可以使用，以后的服务器功能变更也可以这么作，这个对我这样不感冒answerfile的人来说甚好。如果是首次安装，可以什么都不选择，来一个说装就装的默认安装也不错。安装完全成功之后，就会显示登陆网址和 管理与密码等信息。用初始的admin密码登陆后，修改密码，你的全新的foreman就安装成功了。注意在，运行foreman-installer过程中是需要联网的，安装过程会按照需求，下载所需要的组建包，例如数据库和web服务器等等其它必须的包。登陆后界面如下：</p><p>[gallery size=&ldquo;medium&rdquo; link=&ldquo;file&rdquo; ids=&ldquo;53781,53782,53783&rdquo;]</p><p>接下来需要作配置自动化的测试了，我做了一个录像，通过一个简单的示例来说明，如何在foreman中测试pupput module。过程中我使用一个最简单的 /etc/motd 文件的配置的类。演示的内容涉及：</p><p>[su_list icon=&ldquo;icon: check-square&rdquo;]</p><ul><li><p>安装puppet module 到生产环境中</p></li><li><p>导入并且定制puppet 类的功能</p></li><li><p>测试和验证puppet 类是否工作正常</p></li></ul><p>[/su_list]</p><p>视频下载：[su_button url=&ldquo;http://pan.baidu.com/s/1ntpBXfN&rdquo; target=&ldquo;blank&rdquo; style=&ldquo;stroked&rdquo; background="#cccccc" size=&ldquo;6&rdquo; icon=&ldquo;icon: cloud-download&rdquo;]下载在这里[/su_button]</p><p>本文参考文档：</p><ul><li><p><a href=http://theforeman.org/manuals/1.8/index.htm>http://theforeman.org/manuals/1.8/index.htm</a></p></li><li><p><a href=http://itgeeker.net/centos-7-epel-china-mirror-repository/>http://itgeeker.net/centos-7-epel-china-mirror-repository/</a></p></li></ul><a href=https://mp.weixin.qq.com/s/elRqbNlidJzmKCejBwtsAg target=_blank><img src=https://martinliu.cn/images/sref-zs.jpg alt="SRE Foundation 招生简章"></a></article><ul class="pager blog-pager"><li class=previous><a href=https://martinliu.cn/2015/06/13/e794a8-powertop-e7bb99e7ac94e8aeb0e69cace794b5e88491e79c81e794b5/ data-toggle=tooltip data-placement=top title="用 powertop 给笔记本电脑省电">&larr; 前一篇</a></li><li class=next><a href=https://martinliu.cn/2015/06/18/icinga2-e79b91e68ea7e5b7a5e585b7e8af84e6b58b/ data-toggle=tooltip data-placement=top title="icinga2 监控工具评测">后一篇 &rarr;</a></li></ul><div><h2>See Also</h2><ul><li><a href=https://martinliu.cn/2015/06/07/e59ca8centos-7e4b88ae5ae89e8a385e983a8e7bdb2katello2-2/>在CentOS 7上安装部署Katello2.2</a></li><li><a href=https://martinliu.cn/2015/06/05/e5ae89e8a385e5ae8ce7be8e-centos7-e8999ae68b9fe69cbae6a8a1e69dbf/>安装完美 CentOS7 虚拟机模板</a></li><li><a href=https://martinliu.cn/2015/06/04/achillese79a84e8849ae5908ee8b79f/>Achilles的脚后跟</a></li><li><a href=https://martinliu.cn/2015/03/27/e69c8de58aa1e599a8e8999ae68b9fe58c96-rhev/>服务器虚拟化 RHEV</a></li><li><a href=https://martinliu.cn/2014/09/21/start-rhel/>Start over from RHEL</a></li></ul></div></div></div></section></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=mailto:liuzh66@gmail.com title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/martinliu title=GitHub><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://gitlab.com/martinliu title=GitLab><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-gitlab fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/martinliu title=Twitter><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/liuzheng title=LinkedIn><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">&copy;2017-2018
刘征 Martin Liu
&nbsp;&bull;&nbsp;
<a href=https://martinliu.cn/>Martin's Blog</a></p><p class="credits theme-by text-muted">由 <a href=http://gohugo.io>Hugo v0.80.0</a> 强力驱动 &nbsp;&bull;&nbsp; 主题 <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> 移植自 <a href=http://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://res.cloudinary.com/martinliu/raw/upload/static/bootstrap.min.js></script><script src=https://res.cloudinary.com/martinliu/raw/upload/static/photoswipe-ui-default.min.js></script><script src=https://res.cloudinary.com/martinliu/raw/upload/static/photoswipe.min.js></script><script src=https://res.cloudinary.com/martinliu/raw/upload/static/auto-render.min.js></script><script src=https://res.cloudinary.com/martinliu/raw/upload/static/main.js></script><script src=https://res.cloudinary.com/martinliu/raw/upload/static/prism.js></script><script src=https://res.cloudinary.com/martinliu/raw/upload/static/katex.min.js></script><script>renderMathInElement(document.body);</script></body></html>