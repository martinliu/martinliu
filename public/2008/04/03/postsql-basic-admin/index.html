<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>PostgreSQL基本操作指南 - 刘征的博客</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.80.0"><meta property="og:site_name" content="刘征的博客"><meta property="og:title" content="PostgreSQL基本操作指南"><meta property="og:description" content="Martin's Liu is bloging on DevOps and SRE topics"><meta property="description" content="Martin's Liu is bloging on DevOps and SRE topics"><meta property="og:url" content="https://martinliu.cn/2008/04/03/postsql-basic-admin/"><meta property="og:type" content="article"><meta property="og:image" content="https://martinliu.cn/img/main/logo.jpg"><link rel=stylesheet href=/css/bundle.min.d9e04ae08c9b3049b766dbd4aeab7d862c5ea1d13679b621490e0f5df5507497.css integrity="sha256-2eBK4IybMEm3ZtvUrqt9hixeodE2ebYhSQ4PXfVQdJc="><link rel=stylesheet href=/css/add-on.css></head><body><header id=site-header><nav id=site-nav><h1 class=nav-title><a href=/ class=nav>博客</a></h1><menu id=site-nav-menu class="flyout-menu menu"><a href=/ class="nav link"><i class="fas fa-home"></i>首页</a>
<a href=/about/ class="nav link"><i class="far fa-id-card"></i>关于</a>
<a href=/blog/ class="nav link"><i class="far fa-newspaper"></i>博客</a>
<a href=/categories/ class="nav link"><i class="fas fa-sitemap"></i>分类</a>
<a href=/contact/ class="nav link"><i class="far fa-envelope"></i>联系</a>
<a href=#share-menu class="nav link share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
<a href=#search-input class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a></menu>
<a href=#search-input class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
<a href=#share-menu class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
<a href=#lang-menu class="nav lang-toggle" lang=zh-cn>zh-cn</a>
<a href=#site-nav class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a></nav><menu id=search class=menu><input id=search-input class="search-input menu"></input><div id=search-results class="search-results menu"></div></menu><menu id=lang-menu class="flyout-menu menu"><a href=# lang=zh-cn class="nav link active">中文 (zh-cn)</a>
<a href=/en lang=en class="nav no-lang link">English (en)</a></menu>
<menu id=share-menu class="flyout-menu menu"><h1>Share Post</h1><a href="//twitter.com/share?text=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97&url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f" target=_blank rel=noopener class="nav share-btn twitter"><p>Twitter</p></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f" target=_blank rel=noopener class="nav share-btn facebook"><p>Facebook</p></a><a href="//www.reddit.com/submit?url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f&title=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97" target=_blank rel=noopener class="nav share-btn reddit"><p>Reddit</p></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f&title=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97" target=_blank rel=noopener class="nav share-btn linkedin"><p>LinkedIn</p></a><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f&description=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97" target=_blank rel=noopener class="nav share-btn pinterest"><p>Pinterest</p></a><a href="mailto:?subject=%e6%9f%a5%e7%9c%8b%e6%ad%a4%e5%b8%96%e5%ad%90%e7%9a%84%e4%bd%9c%e8%80%85 liuadmin&body=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f" target=_blank class="nav share-btn email" data-proofer-ignore><p>Email</p></a></menu></header><div id=wrapper><section id=site-intro><a href=/><img src=https://martinliu.cn/img/main/logo.jpg class=circle width=100 alt="Martin Liu"></a><header><h1>Martin Liu's Blog</h1></header><main><p>Community Advocate, DevOps China Community Organizer</p></main><footer><ul class=socnet-icons><li><a href=//github.com/martinliu target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//www.linkedin.com/in/liuzheng target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=//twitter.com/martinliu target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li></ul></footer></section><main id=site-main><article class=post><header><div class=title><h2><a href=/2008/04/03/postsql-basic-admin/>PostgreSQL基本操作指南</a></h2></div><div class=meta><time datetime="2008-04-03 08:25:44 +0000 UTC">April 3, 2008</time><p>liuadmin</p><p>2 分钟</p></div></header><div id=socnet-share><a href="//twitter.com/share?text=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97&url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f" target=_blank rel=noopener class="nav share-btn twitter"><p>Twitter</p></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f" target=_blank rel=noopener class="nav share-btn facebook"><p>Facebook</p></a><a href="//www.reddit.com/submit?url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f&title=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97" target=_blank rel=noopener class="nav share-btn reddit"><p>Reddit</p></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f&title=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97" target=_blank rel=noopener class="nav share-btn linkedin"><p>LinkedIn</p></a><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f&description=PostgreSQL%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%e6%8c%87%e5%8d%97" target=_blank rel=noopener class="nav share-btn pinterest"><p>Pinterest</p></a><a href="mailto:?subject=%e6%9f%a5%e7%9c%8b%e6%ad%a4%e5%b8%96%e5%ad%90%e7%9a%84%e4%bd%9c%e8%80%85 liuadmin&body=https%3a%2f%2fmartinliu.cn%2f2008%2f04%2f03%2fpostsql-basic-admin%2f" target=_blank class="nav share-btn email" data-proofer-ignore><p>Email</p></a></div><div class=content><p><strong>安装</strong><br><br>我的安装环境是虚拟机下面安装的CentOS4.4；在安装的时候需要注意的是：在安装选择的时候PostgreSQL一共有十几个可选的包，把可能会用到的包都尽量选中，否则就要手工去安装了，手工解决包之间的依赖关系烦啊。从光盘上装的好处就是它自己帮你把用户和启动脚本建好了，安装后需要检查如下两个文件：1）/etc/init.d/postgresql是否存在；2）/etc/passwd里面有没有postgres用户。<br><br><strong>启动数据库</strong><br><br>第一次启动，用root用户登录，运行命令：[root@RBA init.d]# service postgresql start ；如果需要数据库在系统启动是就启动的话需要运行：<br></p><blockquote>[root@RBA init.d]# chkconfig postgresql on ；</blockquote><p><br>检查结果<br></p><blockquote>[root@RBA ~]# chkconfig --list postgresql<br>postgresql 0:off 1:off 2:on 3:on 4:on 5:on 6:off</blockquote><p><br><strong>数据库管理</strong><br><br>先切到postgres用户 su postgres<br><br>新建一个数据库 createdb amp<br><br>新建一个超级用户，需要在shell下运行：<br></p><blockquote>bash-3.00$ createuser amp<br>Shall the new user be allowed to create databases? (y/n) y<br>Shall the new user be allowed to create more new users? (y/n) y</blockquote><p><br>链接到数据库之后，确认以下：<br></p><blockquote>amp=# \du<br>List of database users<br>User name | User ID | Attributes<br>-----------+---------+----------------------------<br>amp | 100 | superuser, create database<br>postgres | 1 | superuser, create database<br>(2 rows)</blockquote><p><br>给用户加一个密码：<br></p><blockquote>amp=# ALTER USER amp with password 'amp';<br>ALTER USER</blockquote><p><br><strong>其他参考信息</strong><br></p><blockquote># Put your actual configuration here<br># ----------------------------------<br>#<br># CAUTION: The default configuration allows any local user to connect<br># using any PostgreSQL user name, including the superuser, over either<br># Unix-domain sockets or TCP/IP. If you are on a multiple-user<br># machine, the default configuration is probably too liberal for you.<br># Change it to use something other than "trust" authentication.<br>#<br># If you want to allow non-local connections, you need to add more<br># "host" records. Also, remember TCP/IP connections are only enabled<br># if you enable "tcpip_socket" in postgresql.conf.<br># TYPE DATABASE USER IP-ADDRESS IP-MASK METHOD<br>#访问来源 数据库 用户 IP-地址 子网掩码 认证方式<br>local typhoon typhoon md5<br>#对于来自本地的访问，数据库“typhoon”对用户“typhoon”采用“md5”加密口令认证<br>local typhoon all reject<br>#对于来自本地的访问，数据库“typhoon”对上面没提到的所有用户无条件拒绝认证<br>host typhoon typhoon 255.255.255.255 127.0.0.1 md5<br>#对于来网络的访问，数据库“typhoon”对用户“typhoon”，如果提出访问的是本机，采用“md5”加密口令认证<br>host typhoon all 0.0.0.0 0.0.0.0 reject<br>#对于来网络的访问，数据库“typhoon”对上面没提到的所有用户，不管提出访问的哪台机器，也不管它来自哪个子网，无条件拒绝认证<br>local all all md5<br>#对于来自本地的访问，上面没提到的数据库对上面没提到的所有用户采用“md5”加密口令认证<br>host all all 0.0.0.0 0.0.0.0 md5<br>#对于来网络的访问，数上面没提到的数据库对上面没提到的所有用户，不管提出访问的哪台机器，也不管它来自哪个子网，采用“md5”加密口令认证<br>########################################<br># Others are all denied 其他访问一概无条件拒绝<br>local all all reject<br>host all all 0.0.0.0 0.0.0.0 teject<br>########################################<br>########################################<br># All denied permissed, not safe<br># 对所有访问都信任，太不安全，被我禁止掉了，只作为参考<br>#local all all trust<br>#host all all 0.0.0.0 0.0.0.0 trust<br>########################################<br>这些认证的规则是从上到下一条一条加载的，要注意的是，里面的“all”并不是真正意义上的“所有”，只是前面的规定中没有提到的那部分。个人感觉用“other”也许更恰当。<br>这样，最终的结果是：<br>所有用户都能通过加密口令访问“typhoon”以外的数据库，但是只有用户“typhoon”能以加密口令访问数据库“typhoon”。<br>操作篇<br>[客户端基本连接操作]====================<br>*查看PostgreSQL的系统表：<br>(摸索/查找中)<br>*终端登录：<br>psql -l[主机名/IP] -d[数据库名] -U[用户名]<br>*连接到另外一个数据库：<br>\c [数据库名]<br>*断开终端：<br>\q<br>========================================<br>[基本用户管理]==========================<br>*添加用户：<br>create user [用户名];<br>*修改用户密码：<br>alter user [用户名] with password [口令];<br>*删除用户：<br>drop user [用户名];<br>*查看用户信息：<br>(摸索/查找中)<br>========================================<br>[基本数据库操作]========================<br>*创建数据库：<br>create database [数据库名];<br>*查看数据库列表：<br>\d<br>*删除数据库：<br>drop database [数据库名];<br>*修改数据库的所有者：<br>(摸索/查找中)<br>========================================<br>[数据库内基本操作]======================<br>*给予某用户在某数据库创建表的授权：<br>(摸索/查找中)<br>*收回某用户在某数据库创建表的授权：<br>(摸索/查找中)<br>创建表：<br>create table ([字段名1] [类型1] <references 关联表名(关联的字段名)>,[字段名2] [类型2],......<,primary key (字段名m,字段名n,...)>);<br>*查看表名列表：<br>\d<br>*查看某个表的状况：<br>\d [表名]<br>*重命名一个表：<br>alter table [表名A] rename to [表名B];<br>*修改表的所有者：<br>(摸索/查找中)<br>*删除一个表：<br>drop table [表名];<br>========================================<br>[表内基本操作]==========================<br>*在已有的表里添加字段：<br>alter table [表名] add column [字段名] [类型];<br>*删除表中的字段：<br>alter table [表名] drop column [字段名];<br>*重命名一个字段：<br>alter table [表名] rename column [字段名A] to [字段名B];</blockquote></div><footer><div class=stats><ul class=categories><li><a class=article-terms-link href=/categories/infrastructure/>Infrastructure</a></li></ul><ul class=tags><li><a class=article-terms-link href=/tags/postgresql/>PostgreSQL</a></li></ul></div></footer></article><article class=post><div><h2 id=say-something>说些什么</h2><form id=comment-form class=new-comment method=post><h3 class="reply-notice hidden"><span class=reply-name></span></h3><input type=hidden name=options[entryId] value=4357f420dd3269ea65cb0b1ae2d9be6d>
<input type=hidden name=fields[replyThread]>
<input type=hidden name=fields[replyID]>
<input type=hidden name=fields[replyName]>
<input required name=fields[name] type=text placeholder=你的名字>
<input name=fields[website] type=text placeholder=您的网页>
<input required name=fields[email] type=email placeholder=你的邮件>
<textarea required name=fields[body] placeholder=你的信息 rows=10></textarea><div class=submit-notice><strong class="submit-notice-text submit-success hidden">感谢您的评论！被批准后它会立即在此站点展示。</strong>
<strong class="submit-notice-text submit-failed hidden">很抱歉，您的提交存在错误。请确保所有必填字段都已填写正确，然后再试一次。</strong></div><input type=submit value=送出 class=button>
<input type=submit value=已送出 class="hidden button" disabled>
<input type=reset value=重设 class=button></form></div><div><h2>评论</h2><p>还沒有留言。</p></div></article><div class=pagination><a href=/2008/04/05/get-right-size-of-oss/ class="button left"><span>Get right-size of OSS</span></a>
<a href=/2008/04/02/vm-jumpbox-rpath-play-oss/ class="button right"><span>虚拟让你轻松玩开源</span></a></div></main><section id=site-sidebar><section id=recent-posts><header><h1>最新文章</h1></header><article class=mini-post><a href=/blog/workshop-elastic-observability/ class=image style="--bg-image: url('https://martinliu.cn/img/2019/03/pic01.jpg')"><img class=stretchH src=https://martinliu.cn/img/2019/03/pic01.jpg alt=Valley></a><header><h2><a href=/blog/workshop-elastic-observability/>Elastic 可观测性工作坊</a></h2><time class=published datetime="2021-02-06 10:36:12 +0800 CST">February 6, 2021</time></header></article><article class=mini-post><a href=/blog/change-back-on-github-page-again/ class=image style="--bg-image: url('https://martinliu.cn/img/2019/03/pic03.jpg')"><img class=stretchH src=https://martinliu.cn/img/2019/03/pic03.jpg alt=Valley></a><header><h2><a href=/blog/change-back-on-github-page-again/>博客换一个新样式</a></h2><time class=published datetime="2021-02-06 00:00:00 +0000 UTC">February 6, 2021</time></header></article><article class=mini-post><a href=/blog/devopscoach-weekly-6/ class=image style="--bg-image: url('https://martinliu.cn/')"><img src=https://martinliu.cn/ alt></a><header><h2><a href=/blog/devopscoach-weekly-6/>DevOps Coach 周刊 #6</a></h2><time class=published datetime="2020-08-31 00:11:01 +0800 CST">August 31, 2020</time></header></article><article class=mini-post><a href=/blog/elasticsearch-3-nodes-cluster-setup/ class=image style="--bg-image: url('https://martinliu.cn/')"><img src=https://martinliu.cn/ alt></a><header><h2><a href=/blog/elasticsearch-3-nodes-cluster-setup/>Elasticsearch 3 节点集群搭建 (7.9.0)</a></h2><time class=published datetime="2020-08-27 13:54:46 +0800 CST">August 27, 2020</time></header></article><article class=mini-post><a href=/blog/devopscoach-weekly-5/ class=image style="--bg-image: url('https://martinliu.cn/')"><img src=https://martinliu.cn/ alt></a><header><h2><a href=/blog/devopscoach-weekly-5/>DevOps Coach 周刊 #5</a></h2><time class=published datetime="2020-08-25 15:20:51 +0800 CST">August 25, 2020</time></header></article><footer><a href=/blog/ class=button>查看更多</a></footer></section><section id=categories><header><h1><a href=/categories>分类</a></h1></header><ul><li><a href=/categories/blog/>blog<span class=count>107</span></a><li><a href=/categories/itsm/>itsm<span class=count>95</span></a><li><a href=/categories/infrastructure/>infrastructure<span class=count>48</span></a><li><a href=/categories/devops/>devops<span class=count>38</span></a><li><a href=/categories/opensource/>opensource<span class=count>35</span></a><li><a href=/categories/cloud-computing/>cloud-computing<span class=count>27</span></a><li><a href=/categories/running/>running<span class=count>22</span></a><li><a href=/categories/cms/cmdb/>cms/cmdb<span class=count>20</span></a><li><a href=/categories/travel/>travel<span class=count>14</span></a><li><a href=/categories/sre/>sre<span class=count>2</span></a></li></ul></section><section id=mini-bio><header><h1>关于</h1></header><p>This Blog is sharing DevOps and SRE ariticles. I have translated DevOps Handbook and SRE Workbook.</p><footer><a href=/about class=button>学到更多</a></footer></section></section><footer id=site-footer><ul class=socnet-icons><li><a href=//github.com/martinliu target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//www.linkedin.com/in/liuzheng target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=//twitter.com/martinliu target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li></ul><p class=copyright>© 2021 刘征的博客<br>主题: <a href=https://themes.gohugo.io/hugo-future-imperfect-slim/ target=_blank rel=noopener>Hugo Future Imperfect Slim</a><br>移植自 <a href=https://html5up.net/future-imperfect target=_blank rel=noopener>HTML5 UP</a> | 由 <a href=https://gohugo.io/ target=_blank rel=noopener title=0.80.0>Hugo</a> 驱动</p></footer><a id=back-to-top href=# class="fas fa-arrow-up fa-2x"></a><script src=/js/highlight.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/bundle.min.bbba6b424a8ac5b6858cd5fc80eabc9c5277945cc2dc349204646b84891b4b58.js integrity="sha256-u7prQkqKxbaFjNX8gOq8nFJ3lFzC3DSSBGRrhIkbS1g="></script><script src=/js/add-on.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-749876-6','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>